import pygame
import charclassgui
import bulletclass2
import aiclass
import screenclass
import random


WHITE = (255, 255, 255)
BLACK = (0, 0, 0)
RED = (255, 0, 0)
BLUE = (0, 0, 255)
GREEN = (0, 128, 0)
PURPLE = (128, 0, 128)
BROWN = (160, 82, 45)
totalBulletCount = 0

easyColorList = [BLUE, BLUE, BLUE, BLUE, RED, RED, RED, GREEN, GREEN, PURPLE, BLACK, BROWN]
harderColorList = [BLUE, RED, RED, GREEN, PURPLE, PURPLE, PURPLE, BLACK, BLACK, BROWN]
veryHardColorList = [BLUE, RED, GREEN, PURPLE, PURPLE, BLACK, BLACK, BLACK, BROWN]
hardestColorList = [BLACK, BROWN, BROWN, BROWN, BROWN]

pygame.init()

clock = pygame.time.Clock()

'''screen_width = 700
screen_height = 400'''

s = screenclass.background('sahana.jpg', 700, 400)
 
screen = pygame.display.set_mode(s.size)


pygame.display.update()

all_sprites_list = pygame.sprite.Group()
bullet_list = pygame.sprite.Group()

stuf = charclassgui.char('bynn', 'girl.png')
all_sprites_list.add(stuf)

herald = aiclass.combatAi('basketball.png')
all_sprites_list.add(herald)
print('Herald Coordinates: ' +str(herald.getCoordinates()))

done = False

def process(char):
        keys = pygame.key.get_pressed()
        if keys[pygame.K_LEFT]:
                char.left()
                print('Left: ' +str(char.getCoordinates()))
        elif keys[pygame.K_RIGHT]:
                char.right()
                print('Right: ' +str(char.getCoordinates()))
        elif keys[pygame.K_UP]:
                char.up()
                print('Up: ' +str(char.getCoordinates()))
        elif keys[pygame.K_DOWN]:
                char.down()
                print('Down: ' + str(char.getCoordinates()))

def makeBullet(count):
        if(count > 200):
                bullet = bulletclass2.Bullet(herald, random.choice(hardestColorList))
        elif(count > 150):
                bullet = bulletclass2.Bullet(herald, random.choice(veryHardColorList))
        elif(count > 70):
                bullet = bulletclass2.Bullet(herald, random.choice(harderColorList))
        else:
                bullet = bulletclass2.Bullet(herald, random.choice(easyColorList))
        return bullet

print('Health: ' + str(stuf.health))

while not done:
        for event in pygame.event.get():
                keys = pygame.key.get_pressed()
                if event.type == pygame.QUIT:
                        done = True
                elif event.type == pygame.MOUSEBUTTONDOWN:
                        bullet = makeBullet(75)
                        bullet_list.add(bullet)
                        all_sprites_list.add(bullet)
                        print('Bullet Count: ' +str(bullet.count()))
            
                '''if bullet.rect.y > 400:
                    bullet_list.remove(bullet)'''
                                
                for bul in bullet_list:
                        if(pygame.sprite.collide_rect(bul, stuf)):
                                stuf.health -= bul.damage
                                print("Health:", stuf.health)
                                all_sprites_list.remove(bul)
                                bullet_list.remove(bul)
                                if(stuf.health <= 0):
                                        all_sprites_list.remove(stuf)
                                        print("you suck")
        process(stuf)
                    
        all_sprites_list.update()
        screen.fill(WHITE)
        screen.blit(s.image, s.rect)
        all_sprites_list.draw(screen)
        pygame.display.update()

        clock.tick(30) 
        
pygame.quit()

